<!DOCTYPE html>
<html lang="en">
  <head>
    <script type="text/javascript">
      window.SETTINGS = <%= @settings.to_json.html_safe %>
    </script>
    <script type="text/javascript">
      setTimeout(() => { if (!window.LAUNCHED) document.getElementById('error').classList.remove('hidden'); }, 5000);
    </script>
    <style>
      .hidden { display: none !important; }
    </style> 
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons+Outlined" rel="stylesheet">
    <%= stylesheet_link_tag    "atomic_lti/launch" %>
    <%= javascript_include_tag "atomic_lti/init_app" %>
  </head>
  <body>
    <noscript>
      <div class="u-flex">
        <i class="material-icons-outlined aj-icon" aria-hidden="true">warning</i>
        <p class="aj-text">
          You must have javascript enabled to use this application.
        </p> 
      </div>
    </noscript>
    <div id="error" class="hidden u-flex aj-centered-message">
      <i class="material-icons-outlined aj-icon" aria-hidden="true">warning</i>
      <p class="aj-text">
        There was an error launching the LTI tool. Please reload and try again.
      </p>
    </div>
    <div id="cookie_error" class="hidden error aj-centered-message">
      <h1 class="aj-title">
        <i class="material-icons-outlined aj-icon" aria-hidden="true">cookie_off</i>
        Cookies Required
      </h1>
      <p class="aj-text">
        <%= @privacy_policy_html.html_safe %>
      </p>
      <p class="aj-text">
        Please check your browser settings and enable cookies.
      </p>
    </div>
    <div id="launch_new_window" class="hidden aj-centered-message">
      <h1 class="aj-title">
        <i class="material-icons-outlined aj-icon" aria-hidden="true">cookie_off</i>
        Cookies Required
      </h1>
      <p class="aj-text">
        <%= @privacy_policy_html.html_safe %>
      </p>
      <p class="aj-text">
        Please click the button below to reload in a new window.
      </p>
      <button id="button_launch_new_window" class="aj-btn aj-btn--blue">
        Open in a new window
      </button>
      </a>
      <div id="request_storage_access" class="hidden">
        <p class="aj-text">
          If you have used this application before, your browser may allow you to
          <a id="request_storage_access_link" href="#">enable cookies</a>
          and prevent this message in the future.
        </p>
      </div>
      <div id="request_storage_access_error" class="hidden u-flex">
        <i class="material-icons-outlined aj-icon" aria-hidden="true">warning</i>
        <p class="aj-text">
        The browser prevented access.  Try launching in a new window first and then clicking
        this option again next time. If that doesn't work check your privacy settings. 
        Some browsers will prevent all third party cookies.
        </p>
      </div>
    </div>
  </body>
</html>
